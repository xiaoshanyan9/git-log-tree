#!/usr/bin/env bats
# Copyright (C) 2025, 2026 xSY
# SPDX-License-Identifier: GPL-2.0

setup_file() {
  export GIT_WORK_TREE=$(mktemp -d)
  export GIT_DIR=${GIT_WORK_TREE}/.git
  export GIT_CONFIG_GLOBAL=/dev/null
  export GIT_CONFIG_SYSTEM=/dev/null
  git init -q
  git fast-import --quiet << EOF
reset refs/heads/0000011
commit refs/heads/0000011
mark :1
author xSY <> 1765411200 +0000
committer xSY <> 1765411204 +0000
data 118
0000004                                                                	 	   	      	  	 			        	        	       

commit refs/heads/0000007
mark :2
author xSY <> 1765411200 +0000
committer xSY <> 1765411207 +0000
data 70
0000007                  			    			    			 	       	         		      
from :1

reset refs/heads/0000019
commit refs/heads/0000019
mark :3
author xSY <> 1765411200 +0000
committer xSY <> 1765411206 +0000
data 118
0000006                                                                	 	 	   		 		   	 			                 		      

reset refs/heads/0000018
commit refs/heads/0000018
mark :4
author xSY <> 1765411200 +0000
committer xSY <> 1765411201 +0000
data 118
0000001                                                              		 		 	 		 						  	 			    	  	        	       

commit refs/heads/0000018
mark :5
author xSY <> 1765411200 +0000
committer xSY <> 1765411203 +0000
data 70
0000003              		 			 	      		    	  	       	         	      
from :4

commit refs/heads/0000018
mark :6
author xSY <> 1765411200 +0000
committer xSY <> 1765411208 +0000
data 86
0000008                              	   	   							 			   	        	        	       
from :3
merge :5

commit refs/heads/0000010
mark :7
author xSY <> 1765411200 +0000
committer xSY <> 1765411210 +0000
data 70
0000010              	    	 	   	 	 		      	                 	      
from :6

commit refs/heads/0000011
mark :8
author xSY <> 1765411200 +0000
committer xSY <> 1765411211 +0000
data 70
0000011                        	  			 		 	       				        	       
from :1

reset refs/heads/0000014
commit refs/heads/0000014
mark :9
author xSY <> 1765411200 +0000
committer xSY <> 1765411202 +0000
data 118
0000002                                                              	 			 	  	 		  		  	  		      		                

reset refs/heads/0000014
commit refs/heads/0000014
mark :10
author xSY <> 1765411200 +0000
committer xSY <> 1765411213 +0000
data 118
0000013                                                                	 				   	   	              		        		      

commit refs/heads/0000014
mark :11
author xSY <> 1765411200 +0000
committer xSY <> 1765411214 +0000
data 86
0000014                              	  	  	 	 			 				 	  	                 		      
from :9
merge :10

reset refs/heads/0000016
commit refs/heads/0000016
mark :12
author xSY <> 1765411200 +0000
committer xSY <> 1765411205 +0000
data 118
0000005                                                                						 			 	 			  	  	      		         	      

reset refs/heads/0000016
commit refs/heads/0000016
mark :13
author xSY <> 1765411200 +0000
committer xSY <> 1765411209 +0000
data 118
0000009                                                               	   	 		  	   	 	    	        	        	       

commit refs/heads/0000016
mark :14
author xSY <> 1765411200 +0000
committer xSY <> 1765411212 +0000
data 86
0000012                              	   	  	    	   			  		      		                 
from :6
merge :13

commit refs/heads/0000016
mark :15
author xSY <> 1765411200 +0000
committer xSY <> 1765411215 +0000
data 70
0000015                		    	  			 		 	  	 	                        
from :14

commit refs/heads/0000016
mark :16
author xSY <> 1765411200 +0000
committer xSY <> 1765411216 +0000
data 86
0000016                              		   	  				 	 	 	 		          	         	      
from :12
merge :15

reset refs/heads/0000017
commit refs/heads/0000017
mark :17
author xSY <> 1765411200 +0000
committer xSY <> 1765411217 +0000
data 118
0000017                                                              		 		   	 			     					                 	       

commit refs/heads/0000018
mark :18
author xSY <> 1765411200 +0000
committer xSY <> 1765411218 +0000
data 70
0000018               			 		   	   		 		  		       	         	       
from :6

commit refs/heads/0000019
mark :19
author xSY <> 1765411200 +0000
committer xSY <> 1765411219 +0000
data 70
0000019               		 		 				  		  		   	                 	       
from :3

EOF
}

teardown_file() {
  rm -f -r "${GIT_WORK_TREE}"
}

setup() {
  bats_load_library bats-support
  bats_load_library bats-assert
}

test_4A81() { #@test
  BATS_TEST_DESCRIPTION=4A81
  run "$(dirname "${BATS_TEST_DIRNAME}")/git-log-tree" --all --date-order --color
  assert_success
  assert_output - << EOF
[1;38;2;243;139;168mâ—[m [m[33m0000019[m[33m ([m[1;32m0000019[m[33m)[m 0000019
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ—[m [m[33m0000018[m[33m ([m[1;32m0000018[m[33m)[m 0000018
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;166;227;161mâ—[m [m[33m0000017[m[33m ([m[1;32m0000017[m[33m)[m 0000017
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m   [1;38;2;148;226;213mâ—[m[1;38;2;166;227;161mâ”€â•®[m [m[33m0000016[m[33m ([m[1;32m0000016[m[33m)[m 0000016
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ•­â”€â•¯[m [1;38;2;166;227;161mâ—[m [m[33m0000015[m 0000015
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ•­â”€â•¯[m [1;38;2;137;180;250mâ—[m[1;38;2;203;166;247mâ”€â•®[m [m[33m0000014[m[33m ([m[1;32m0000014[m[33m)[m 0000014
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ”‚[m [1;38;2;137;180;250mâ•­â”€â•¯[m [1;38;2;203;166;247mâ—[m [m[33m0000013[m 0000013
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ—[m[1;38;2;245;194;231mâ”€[m[1;38;2;137;180;250mâ”‚[m[1;38;2;245;194;231mâ”€â•®[m [m[33m0000012[m 0000012
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ”‚[m [1;38;2;137;180;250mâ”‚[m [1;38;2;245;194;231mâ”‚[m [1;38;2;243;139;168mâ—[m [m[33m0000011[m[33m ([m[1;32m0000011[m[33m)[m 0000011
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ”‚[m [1;38;2;137;180;250mâ”‚[m [1;38;2;245;194;231mâ”‚[m [1;38;2;243;139;168mâ”‚[m [1;38;2;203;166;247mâ—[m [m[33m0000010[m[33m ([m[1;32m0000010[m[33m)[m 0000010
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;166;227;161mâ”‚[m [1;38;2;137;180;250mâ”‚[m [1;38;2;245;194;231mâ—[m [1;38;2;243;139;168mâ”‚[m [1;38;2;203;166;247mâ”‚[m [m[33m0000009[m 0000009
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ—[m[1;38;2;166;227;161mâ”€[m[1;38;2;148;226;213mâ”‚[m[1;38;2;166;227;161mâ”€â•¯[m[1;38;2;250;179;135mâ”€[m[1;38;2;137;180;250mâ”‚[m[1;38;2;250;179;135mâ”€â•®[m[1;38;2;203;166;247mâ”€[m[1;38;2;243;139;168mâ”‚[m[1;38;2;203;166;247mâ”€â•¯[m [m[33m0000008[m 0000008
[1;38;2;243;139;168mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;148;226;213mâ”‚[m [1;38;2;137;180;250mâ•­â”€â•¯[m [1;38;2;250;179;135mâ”‚[m [1;38;2;243;139;168mâ”‚[m [1;38;2;166;227;161mâ—[m [m[33m0000007[m[33m ([m[1;32m0000007[m[33m)[m 0000007
[1;38;2;243;139;168mâ—[m[1;38;2;250;179;135mâ”€â•¯[m [1;38;2;148;226;213mâ”‚[m [1;38;2;137;180;250mâ”‚[m [1;38;2;250;179;135mâ•­â”€â•¯[m [1;38;2;243;139;168mâ”‚[m [1;38;2;166;227;161mâ”‚[m [m[33m0000006[m 0000006
  [1;38;2;148;226;213mâ—[m[1;38;2;148;226;213mâ”€â•¯[m [1;38;2;137;180;250mâ”‚[m [1;38;2;250;179;135mâ”‚[m [1;38;2;243;139;168mâ•­â”€â•¯[m [1;38;2;166;227;161mâ”‚[m [m[33m0000005[m 0000005
[1;38;2;137;180;250mâ•­â”€â”€â”€â”€â”€â•¯[m [1;38;2;250;179;135mâ”‚[m [1;38;2;243;139;168mâ—[m[1;38;2;166;227;161mâ”€â”€[1;38;2;166;227;161mâ”€â•¯[m [m[33m0000004[m 0000004
[1;38;2;137;180;250mâ”‚[m [1;38;2;250;179;135mâ—[m[1;38;2;250;179;135mâ”€â”€[1;38;2;250;179;135mâ”€â”€[1;38;2;250;179;135mâ”€â•¯[m [m[33m0000003[m 0000003
[1;38;2;137;180;250mâ—[m [1;38;2;250;179;135mâ”‚[m [m[33m0000002[m 0000002
  [1;38;2;250;179;135mâ—[m [m[33m0000001[m 0000001
EOF
}
